<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Android 基础-RecyclerView · 党学义的博客</title><meta name="description" content="Android 基础-RecyclerView - dangxy"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="党学义的博客"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/categories/" target="_self" class="nav-list-link">CATEGORIES</a></li><li class="nav-list-item"><a href="/tags/" target="_self" class="nav-list-link">TAGS</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">ABOUT</a></li><li class="nav-list-item"><a href="https://github.com/dangxy" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Android 基础-RecyclerView</h1><div class="post-info">Dec 2, 2017</div><div class="post-content"><h3 id="RecyclerView基本概念"><a href="#RecyclerView基本概念" class="headerlink" title="RecyclerView基本概念:"></a>RecyclerView基本概念:</h3><p>RecyclerView是Android 5.0提出的新UI控件，位于support-v7包中，可以通过在build.gradle中添加<br><code>compile &#39;com.android.support:recyclerview-v7:24.2.1&#39;</code>导入。<br>RecyclerView的官方定义如下：<br>A flexible view for providing a limited window into a large data set.</p>
<a id="more"></a>
<p>RecyclerView 必知必会 [<a href="https://mp.weixin.qq.com/s?__biz=MzA3NTYzODYzMg==&amp;mid=2653578459&amp;idx=2&amp;sn=88e91636429e66b2c80874645478f32f&amp;chksm=84b3b6dcb3c43fcac11f5d8085b45ab4bdf2a148708b55659262a780000a6b7633eefc8404f8&amp;mpshare=1&amp;scene=1&amp;srcid=0105TDqechavWz0mSxgdssUN%23rd" target="_blank" rel="external">RecyclerView 必知必会</a>]</p>
<h3 id="RecyclerView的标准实现步骤如下："><a href="#RecyclerView的标准实现步骤如下：" class="headerlink" title="RecyclerView的标准实现步骤如下："></a>RecyclerView的标准实现步骤如下：</h3><ul>
<li>创建Adapter：创建一个继承RecyclerView.Adapter<vh>的Adapter类（VH是ViewHolder的类名），记为NormalAdapter。</vh></li>
<li>创建ViewHolder：在NormalAdapter中创建一个继承RecyclerView.ViewHolder的静态内部类，记为VH。ViewHolder的实现和ListView的ViewHolder实现几乎一样。</li>
<li>在NormalAdapter中实现：VH onCreateViewHolder(ViewGroup parent, int viewType): 映射Item Layout Id，创建VH并返回。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">需要注意的是在onCreateViewHolder()中，映射Layout必须为</div><div class="line">View v = LayoutInflater.from(parent.getContext()).inflate(R.layout.item_1, parent, <span class="keyword">false</span>);</div><div class="line">而不能是：</div><div class="line">View v = LayoutInflater.from(parent.getContext()).inflate(R.layout.item_1, <span class="keyword">null</span>);</div></pre></td></tr></table></figure>
<pre><code>* void onBindViewHolder(VH holder, int position): 为holder设置指定数据。
* int getItemCount(): 返回Item的个数。
</code></pre><p>可以看出，RecyclerView将ListView中getView()的功能拆分成了onCreateViewHolder()和onBindViewHolder()。<br>创建完Adapter，接着对RecyclerView进行设置，一般来说，需要为RecyclerView进行四大设置，也就是后文说的四大组成：</p>
<h3 id="Adapter-必选"><a href="#Adapter-必选" class="headerlink" title="Adapter(必选)"></a>Adapter(必选)</h3><p>为了创建一个RecyclerView的Adapter，每次我们都需要去做重复劳动，包括重写onCreateViewHolder(),getItemCount()、创建ViewHolder，并且实现过程大同小异，因此万能适配器出现了，他能通过以下方式快捷地创建一个Adapter<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeAdapter</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">Adapter</span>&lt;<span class="title">HomeAdapter</span>.<span class="title">MyViewHolder</span>&gt;</span></div><div class="line">    &#123;</div><div class="line">     <span class="comment">//创建子项item的布局</span></div><div class="line">         <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> MyViewHolder <span class="title">onCreateViewHolder</span><span class="params">(ViewGroup parent, <span class="keyword">int</span> viewType)</span></span></div><div class="line">        &#123;</div><div class="line">            MyViewHolder holder = <span class="keyword">new</span> MyViewHolder(LayoutInflater.from(</div><div class="line">                    HomeActivity.<span class="keyword">this</span>).inflate(R.layout.item_home, parent,</div><div class="line">                    <span class="keyword">false</span>));</div><div class="line">            <span class="keyword">return</span> holder;</div><div class="line">        &#125;</div><div class="line">			<span class="comment">//给控件设置数据</span></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBindViewHolder</span><span class="params">(MyViewHolder holder, <span class="keyword">int</span> position)</span></span></div><div class="line">        &#123;</div><div class="line">            holder.tv.setText(mDatas.get(position));</div><div class="line">        &#125;</div><div class="line">		 <span class="comment">//子项item的数量</span></div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemCount</span><span class="params">()</span></span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">return</span> mDatas.size();</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="class"><span class="keyword">class</span> <span class="title">MyViewHolder</span> <span class="keyword">extends</span> <span class="title">ViewHolder</span></span></div><div class="line">        &#123;</div><div class="line"></div><div class="line">            TextView tv;</div><div class="line"></div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="title">MyViewHolder</span><span class="params">(View view)</span></span></div><div class="line">            &#123;</div><div class="line">                <span class="keyword">super</span>(view);</div><div class="line">                tv = (TextView) view.findViewById(R.id.id_num);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="Layout-Manager-必选"><a href="#Layout-Manager-必选" class="headerlink" title="Layout Manager(必选)"></a>Layout Manager(必选)</h3><p>RecyclerView.LayoutManager吧，这是一个抽象类，好在系统提供了3个实现类：</p>
<ol>
<li>LinearLayoutManager 现行管理器，支持横向、纵向。</li>
<li>GridLayoutManager 网格布局管理器</li>
<li>StaggeredGridLayoutManager 瀑布就式布局管理器<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">mRecyclerView.setLayoutManager(<span class="keyword">new</span> LinearLayoutManager(<span class="keyword">this</span>));</div><div class="line">mRecyclerView.setLayoutManager(<span class="keyword">new</span> GridLayoutManager(<span class="keyword">this</span>,<span class="number">4</span>));</div><div class="line"><span class="comment">//ListView形式上下滑动：</span></div><div class="line">mMain_recyclerview.setLayoutManager(<span class="keyword">new</span> LinearLayoutManager(<span class="keyword">this</span>));</div><div class="line"><span class="comment">//左右滑动：</span></div><div class="line">LinearLayoutManager magager = <span class="keyword">new</span> LinearLayoutManager(<span class="keyword">this</span>);</div><div class="line">magager.setOrientation(LinearLayoutManager.HORIZONTAL);</div><div class="line"><span class="comment">//Grid形式上下滑动：</span></div><div class="line">GridLayoutManager layoutManager = <span class="keyword">new</span> GridLayoutManager(<span class="keyword">this</span>,<span class="number">4</span>);</div><div class="line"><span class="comment">//Grid形式左右滑动：</span></div><div class="line">GridLayoutManager layoutManager = <span class="keyword">new</span> GridLayoutManager(<span class="keyword">this</span>, <span class="number">4</span>);</div><div class="line">layoutManager.setOrientation(GridLayoutManager.HORIZONTAL);</div><div class="line"><span class="comment">//瀑布流形式上下滑动：</span></div><div class="line">StaggeredGridLayoutManager layoutManager = newStaggeredGridLayoutManager(<span class="number">4</span>, StaggeredGridLayoutManager.VERTICAL);</div><div class="line"><span class="comment">//瀑布流形式左右滑动：</span></div><div class="line">StaggeredGridLayoutManager layoutManager = newStaggeredGridLayoutManager(<span class="number">4</span>, StaggeredGridLayoutManager.HORIZONTAL);</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="Item-Decoration-可选，默认为空"><a href="#Item-Decoration-可选，默认为空" class="headerlink" title="Item Decoration(可选，默认为空)"></a>Item Decoration(可选，默认为空)</h3><p>mRecyclerView.addItemDecoration()<br>该方法的参数为RecyclerView.ItemDecoration，该类为抽象类，官方目前并没有提供默认的实现类<br>我们调用mRecyclerView.addItemDecoration()方法添加decoration的时候，RecyclerView在绘制的时候，去会绘制decorator，即调用该类的onDraw和onDrawOver方法，<br>onDraw方法先于drawChildren   绘制分割线。<br>onDrawOver在drawChildren之后，一般我们选择复写其中一个即可。<br>getItemOffsets 可以通过outRect.set()为每个Item设置一定的偏移量，主要用于绘制Decorator。设置分割线的宽、高。<br>首先看构造函数，构造函数中获得系统属性android:listDivider，该属性是一个Drawable对象。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ItemDecoration</span> </span>&#123;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas c, RecyclerView parent, State state)</span> </span>&#123;</div><div class="line">            onDraw(c, parent);</div><div class="line"> &#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDrawOver</span><span class="params">(Canvas c, RecyclerView parent, State state)</span> </span>&#123;</div><div class="line">            onDrawOver(c, parent);</div><div class="line"> &#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getItemOffsets</span><span class="params">(Rect outRect, View view, RecyclerView parent, State state)</span> </span>&#123;</div><div class="line">            getItemOffsets(outRect, ((LayoutParams) view.getLayoutParams()).getViewLayoutPosition(),</div><div class="line">                    parent);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">@Deprecated</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">getItemOffsets</span><span class="params">(Rect outRect, <span class="keyword">int</span> itemPosition, RecyclerView parent)</span> </span>&#123;</div><div class="line">            outRect.set(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>
<h3 id="Item-Animator-可选，默认为DefaultItemAnimator"><a href="#Item-Animator-可选，默认为DefaultItemAnimator" class="headerlink" title="Item Animator(可选，默认为DefaultItemAnimator)"></a>Item Animator(可选，默认为DefaultItemAnimator)</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 设置item动画</span></div><div class="line">mRecyclerView.setItemAnimator(<span class="keyword">new</span> DefaultItemAnimator());</div></pre></td></tr></table></figure>
<h3 id="多布局"><a href="#多布局" class="headerlink" title="多布局"></a>多布局</h3><ol>
<li><p>实现多布局最核心的方法就是在Adapter中重写getItemViewType方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getItemViewType</span><span class="params">(<span class="keyword">int</span> position)</span> </span>&#123;    </div><div class="line">    <span class="keyword">if</span> (mNewsBeanList.get(position).getThumbnail_pic_s03() == <span class="keyword">null</span>) &#123;        </div><div class="line">        <span class="keyword">return</span> IMAGE_ONLY_ONE;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;        </div><div class="line">        <span class="keyword">return</span> IMAGE_TWOORTHREE;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>在onCreateViewHolder方法中第二个参数对应的就是上面方法返回的值，我们根据值的不同，填充不同的布局</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="keyword">public</span> RecyclerView.<span class="function">ViewHolder <span class="title">onCreateViewHolder</span><span class="params">(ViewGroup viewGroup, <span class="keyword">int</span> viewType)</span> </span>&#123;    </div><div class="line">    <span class="keyword">if</span> (viewType == IMAGE_TWOORTHREE) &#123;</div><div class="line">        View view = LayoutInflater.from(viewGroup.getContext()).inflate(R.layout.news_imagethree_item, viewGroup, <span class="keyword">false</span>);</div><div class="line">        ImageThreeViewHolder viewHolder = <span class="keyword">new</span> ImageThreeViewHolder(view);        </div><div class="line">        <span class="keyword">return</span> viewHolder;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        View view = LayoutInflater.from(viewGroup.getContext()).inflate(R.layout.news_imageonly_item, viewGroup, <span class="keyword">false</span>);</div><div class="line">        ImageOnlyOneViewHolder viewHolder = <span class="keyword">new</span> ImageOnlyOneViewHolder(view);        </div><div class="line">        <span class="keyword">return</span> viewHolder;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>不同的布局需要不同的ViewHolder</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ImageThreeViewHolder</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">ViewHolder</span> </span>&#123;    </div><div class="line">    <span class="keyword">private</span> TextView mTv_title;    </div><div class="line">    <span class="keyword">private</span> ImageView mIv_image01;    </div><div class="line">    <span class="keyword">private</span> ImageView mIv_image02;    </div><div class="line">    <span class="keyword">private</span> ImageView mIv_image03;    </div><div class="line">    <span class="keyword">private</span> TextView mTv_company;    </div><div class="line">    <span class="keyword">private</span> TextView mTv_time;    </div><div class="line">    <span class="keyword">private</span> View mItemView;    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ImageThreeViewHolder</span><span class="params">(View itemView)</span> </span>&#123;        </div><div class="line">        <span class="keyword">super</span>(itemView);</div><div class="line">        mItemView = itemView;</div><div class="line">        mTv_title = itemView.findViewById(R.id.tv_title);</div><div class="line">        mIv_image01 = itemView.findViewById(R.id.iv_image01);</div><div class="line">        mIv_image02 = itemView.findViewById(R.id.iv_image02);</div><div class="line">        mIv_image03 = itemView.findViewById(R.id.iv_image03);</div><div class="line">        mTv_company = itemView.findViewById(R.id.tv_company);</div><div class="line">        mTv_time = itemView.findViewById(R.id.tv_time);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">     </div><div class="line"><span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">ImageOnlyOneViewHolder</span> <span class="keyword">extends</span> <span class="title">RecyclerView</span>.<span class="title">ViewHolder</span> </span>&#123;    </div><div class="line">    <span class="keyword">private</span> View mItemView;    </div><div class="line">    <span class="keyword">private</span> TextView mTv_title;    </div><div class="line">    <span class="keyword">private</span> TextView mTv_company;    </div><div class="line">    <span class="keyword">private</span> TextView mTv_time;    </div><div class="line">    <span class="keyword">private</span> ImageView mIv_image01;    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ImageOnlyOneViewHolder</span><span class="params">(View itemView)</span> </span>&#123;        </div><div class="line">        <span class="keyword">super</span>(itemView);</div><div class="line">        mItemView = itemView;</div><div class="line">        mTv_title = itemView.findViewById(R.id.tv_title);</div><div class="line">        mTv_company = itemView.findViewById(R.id.tv_company);</div><div class="line">        mTv_time = itemView.findViewById(R.id.tv_time);</div><div class="line">        mIv_image01 = itemView.findViewById(R.id.iv_image01);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>onBindViewHolder方法中的第一个参数对应不同的viewholder，我们通过判断，来进行每个元素的写入</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function">ublic <span class="keyword">void</span> <span class="title">onBindViewHolder</span><span class="params">(RecyclerView.ViewHolder viewHolder, <span class="keyword">int</span> position)</span> </span>&#123;    </div><div class="line">    </div><div class="line">    <span class="keyword">if</span> (viewHolder <span class="keyword">instanceof</span> ImageThreeViewHolder) &#123;</div><div class="line">        ((ImageThreeViewHolder) viewHolder).mTv_title.setText(mNewsBeanList.get(position).getTitle());</div><div class="line">        ((ImageThreeViewHolder) viewHolder).mTv_company.setText(mNewsBeanList.get(position).getAuthor_name());</div><div class="line">        ((ImageThreeViewHolder) viewHolder).mTv_time.setText(mNewsBeanList.get(position).getDate());</div><div class="line"></div><div class="line">        Glide.with(mContext).load(mNewsBeanList.get(position).getThumbnail_pic_s()).into(((ImageThreeViewHolder) viewHolder).mIv_image01);</div><div class="line">        Glide.with(mContext).load(mNewsBeanList.get(position).getThumbnail_pic_s02()).into(((ImageThreeViewHolder) viewHolder).mIv_image02);</div><div class="line">        Glide.with(mContext).load(mNewsBeanList.get(position).getThumbnail_pic_s03()).into(((ImageThreeViewHolder) viewHolder).mIv_image03);</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (viewHolder <span class="keyword">instanceof</span> ImageOnlyOneViewHolder) &#123;</div><div class="line">        ((ImageOnlyOneViewHolder) viewHolder).mTv_title.setText(mNewsBeanList.get(position).getTitle());</div><div class="line">        ((ImageOnlyOneViewHolder) viewHolder).mTv_company.setText(mNewsBeanList.get(position).getAuthor_name());</div><div class="line">        ((ImageOnlyOneViewHolder) viewHolder).mTv_time.setText(mNewsBeanList.get(position).getDate());</div><div class="line"></div><div class="line">        Glide.with(mContext).load(mNewsBeanList.get(position).getThumbnail_pic_s()).into(((ImageOnlyOneViewHolder) viewHolder).mIv_image01);</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="下拉刷新"><a href="#下拉刷新" class="headerlink" title="下拉刷新"></a>下拉刷新</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Override</span></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initRefresh</span><span class="params">()</span> </span>&#123;</div><div class="line">    srRefresh.setColorSchemeResources(R.color.colorPrimary);</div><div class="line">    srRefresh.setOnRefreshListener(<span class="keyword">new</span> SwipeRefreshLayout.OnRefreshListener() &#123;        </div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onRefresh</span><span class="params">()</span> </span>&#123;</div><div class="line">            refreshFruits();</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">refreshFruits</span><span class="params">()</span> </span>&#123;    </div><div class="line">    <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;        </div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;            </div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                Thread.sleep(<span class="number">2000</span>);</div><div class="line">            &#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">            runOnUiThread(<span class="keyword">new</span> Runnable() &#123;                </div><div class="line">                <span class="meta">@Override</span></div><div class="line">                <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                    initFruits();</div><div class="line">                    adapter.notifyDataSetChanged();</div><div class="line">                    srRefresh.setRefreshing(<span class="keyword">false</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;);</div><div class="line">        &#125;</div><div class="line">    &#125;).start();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initFruits</span><span class="params">()</span> </span>&#123;</div><div class="line">    fruitList.clear();    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">50</span>; i++) &#123;</div><div class="line">        Random random = <span class="keyword">new</span> Random();        </div><div class="line">        <span class="keyword">int</span> index = random.nextInt(fruits.length);</div><div class="line">        fruitList.add(fruits[index]);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="上拉加载"><a href="#上拉加载" class="headerlink" title="上拉加载"></a>上拉加载</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">recyclerView.addOnScrollListener(<span class="keyword">new</span> RecyclerView.OnScrollListener() &#123;        </div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onScrollStateChanged</span><span class="params">(RecyclerView recyclerView, <span class="keyword">int</span> newState)</span> </span>&#123;            </div><div class="line">            <span class="keyword">super</span>.onScrollStateChanged(recyclerView, newState);            </div><div class="line">            <span class="keyword">if</span> (newState == RecyclerView.SCROLL_STATE_IDLE) &#123;                </div><div class="line">                <span class="keyword">if</span> (adapter.isFadeTips() == <span class="keyword">false</span> &amp;&amp; lastVisibleItem + <span class="number">1</span> == adapter.getItemCount()) &#123;</div><div class="line">                    mHandler.postDelayed(<span class="keyword">new</span> Runnable() &#123;                        </div><div class="line">                        <span class="meta">@Override</span></div><div class="line">                        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                            updateRecyclerView(adapter.getRealLastPosition(), adapter.getRealLastPosition() + PAGE_COUNT);</div><div class="line">                        &#125;</div><div class="line">                    &#125;, <span class="number">500</span>);</div><div class="line">                &#125;                </div><div class="line">                <span class="keyword">if</span> (adapter.isFadeTips() == <span class="keyword">true</span> &amp;&amp; lastVisibleItem + <span class="number">2</span> == adapter.getItemCount()) &#123;</div><div class="line">                    mHandler.postDelayed(<span class="keyword">new</span> Runnable() &#123;                        </div><div class="line">                        <span class="meta">@Override</span></div><div class="line">                        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</div><div class="line">                            updateRecyclerView(adapter.getRealLastPosition(), adapter.getRealLastPosition() + PAGE_COUNT);</div><div class="line">                        &#125;</div><div class="line">                    &#125;, <span class="number">500</span>);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;        </div><div class="line">        <span class="meta">@Override</span></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onScrolled</span><span class="params">(RecyclerView recyclerView, <span class="keyword">int</span> dx, <span class="keyword">int</span> dy)</span> </span>&#123;            </div><div class="line">            <span class="keyword">super</span>.onScrolled(recyclerView, dx, dy);</div><div class="line">            lastVisibleItem = mLayoutManager.findLastVisibleItemPosition();</div><div class="line"></div><div class="line">        &#125;</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
</div></article></div></main><footer><div class="paginator"><a href="/2017/12/03/Android-okhttp的基本用法/" class="prev">PREV</a><a href="/2017/08/09/数据库- Room 错误tips/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2018 <a href="http://yoursite.com">dangxy</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>